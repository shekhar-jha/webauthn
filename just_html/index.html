<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
    <script src="fido.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/u2f-api@latest/bundle.js"></script>
    <title>Webauthn & Passkey demo</title>
    <style>
        table, th, td {
            border-collapse: collapse;
        }

        .simpleTable table, .simpleTable th, .simpleTable td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 5px;
        }

        th {
            font-weight: bold;
        }

        .emptyTable table, .emptyTable th, .emptyTable td {
            border: none;
            padding: 5px;
        }
    </style>
</head>
<body data-externalURL="{{ .ExternalURL }}">
<h1>Detected capability</h1>
<table class="simpleTable">
    <thead>
    <tr>
        <th>Attribute</th>
        <th>Value</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>Secure</td>
        <td>
            <div id="IsSecure"></div>
        </td>
    </tr>
    <tr>
        <td>U2F</td>
        <td>
            <div id="HasU2F"></div>
        </td>
    </tr>
    <tr>
        <td>Webauthn</td>
        <td>
            <div id="HasWebAuthn"></div>
        </td>
    </tr>
    <tr>
        <td><a href="https://w3c.github.io/webappsec-credential-management/#mediation-requirements" target="_blank">Webauthn.Conditional
            mediation supported</a></td>
        <td>
            <div id="mediation"></div>
        </td>
    </tr>
    <tr>
        <td><a href="https://w3c.github.io/webauthn/#user-verifying-platform-authenticator" target="_blank">Webauthn.User-verifying
            platform authenticator</a><BR>(Platform authenticator supported)
        </td>
        <td>
            <div id="userVerifyPlatformAuthn"></div>
        </td>
    </tr>
    </tbody>
</table>
<H1>Configuration</H1>

<table class="simpleTable">
    <thead>
    <tr>
        <th>Attribute</th>
        <th>Value</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>Identity</td>
        <td><input type="text" id="userId" name="userId" value=""></input></td>
    </tr>
    <td>External URL</td>
    <td><input type="text" id="externalURL" name="externalURL" value=""></input></td>
    </tr>
    </tbody>
</table>

<H1>Operations</H1>

<H2>Session</H2>
<table class="emptyTable">
    <tbody>
    <tr>
        <td>
            <label for="sessions-new-desc">New Session Description</label><BR>
        </td>
        <td>
            <input type="text" name="sessions-new-desc" id="sessions-new-desc" value=""
                   placeholder="sample desc for new session"/>
        </td>
        <td rowspan="2"><input type="button" value="Create new session" onclick="createSession()"/></td>
    </tr>
    <tr>
        <td>
            <label for="sessions-new-user">Session user</label><BR>
        </td>
        <td>
            <input type="text" name="sessions-new-user" id="sessions-new-user" value=""
                   placeholder="testUser1"/>
        </td>
    </tr>
    <tr>
        <td><label for="sessions">Current Sessions</label></td>
        <td>
            <select name="sessions" id="sessions" onchange="selectSession();">
                <option value="session-invalid">No sessions defined</option>
            </select>
        </td>
    </tr>
    </tbody>
</table>

<H2>navigator.credentials</H2>
<label for="operationName">Operation</label><select name="operationName" id="operationName"
                                                    onchange="ShowTab('operationName','credential-','nav-cred-')">
    <option value="credential-create">Create</option>
    <option value="credential-get">Get</option>
    <option value="credential-store">Store</option>
    <option value="credential-prevent">Prevent silent access</option>
</select>
<div id="nav-cred-create" class="nav-creds">
    <H3>Create</H3>
    <div class="tab">
        <button id='nav-cred-createSectionLink-logging' class="tablinks"
                onclick="ShowSection('nav-cred-createSections','tablinks','nav-cred-createSection-logging', 'nav-cred-createSectionLink-logging')">
            Logging
        </button>
        <button id='nav-cred-createSectionLink-credOpts' class="tablinks active"
                onclick="ShowSection('nav-cred-createSections','tablinks','nav-cred-createSection-credOpts', 'nav-cred-createSectionLink-credOpts')">
            Credential
            Options
        </button>
        <button id='nav-cred-createSectionLink-genCreds' class="tablinks"
                onclick="ShowSection('nav-cred-createSections','tablinks', 'nav-cred-createSection-genCreds', 'nav-cred-createSectionLink-genCreds')">
            Credential
        </button>
    </div>
    <div id="nav-cred-createSection-logging" class="nav-cred-createSections tabcontent" style="display: none">
        <p>
            <input type="button" value="Clear" onclick="clearLog('nav-cred-create-logging')"/>
        </p>
        <div id="nav-cred-create-logging"></div>
    </div>
    <div id="nav-cred-createSection-credOpts" class="nav-cred-createSections tabcontent" style="display: block">
        <table class="emptyTable">
            <tr>
                <td><label for="nav-cred-create-fillOptions-Values">
                    <input type="button"
                           name="nav-cred-create-fillOptions"
                           value="Load Credential Option"
                           onclick="SetObject(DefaultCredOptions, 'nav-cred-create','nav-cred-create');"></label>
                </td>
                <td><select name="nav-cred-create-fillOptions-Values"
                            id="nav-cred-create-fillOptions-Values">
                    <option value="Empty" selected>Empty</option>
                    <option value="Default">Default</option>
                    <option value="ServerSide">From server</option>
                </select>
                </td>
            </tr>
            <tr>
                <td colspan="2"><input type="button" name="nav-cred-create-generateObject"
                                       value="Generate Create Credential Option"
                                       onclick="currentSession['nav-cred-create-options'] = GenerateObject('nav-cred-create');ShowSection('nav-cred-createSections','tablinks', 'nav-cred-createSection-genCreds', 'nav-cred-createSectionLink-genCreds')">
                </td>
            </tr>
            <tr>
                <td>Show/Hide section</td>
                <td>
                    <label for="nav-cred-createOptionBox-rp">Relying Party</label>
                    <input type="checkbox" id="nav-cred-createOptionBox-rp" name="nav-cred-createOptions-rp"
                           class="nav-cred-createOptionBox" checked
                           onchange="ShowSection('nav-cred-createOptions-rp','nav-cred-createOptionBox', 'nav-cred-createOptions-rp', 'nav-cred-createOptionBox-rp', true, 'checkbox', 'table')">
                    <label for="nav-cred-createOptionBox-user">User</label>
                    <input type="checkbox" id="nav-cred-createOptionBox-user" name="nav-cred-createOptions-user"
                           class="nav-cred-createOptionBox" checked
                           onchange="ShowSection('nav-cred-createOptions-user','nav-cred-createOptionBox', 'nav-cred-createOptions-user', 'nav-cred-createOptionBox-user', true, 'checkbox', 'table')">
                    <label for="nav-cred-createOptionBox-others">Other attributes</label>
                    <input type="checkbox" id="nav-cred-createOptionBox-others" name="nav-cred-createOptions-others"
                           class="nav-cred-createOptionBox" checked
                           onchange="ShowSection('nav-cred-createOptions-others','nav-cred-createOptionBox', 'nav-cred-createOptions-others', 'nav-cred-createOptionBox-others', true, 'checkbox', 'table')">
                    <label for="nav-cred-createOptionBox-exclude">Credential Exclusion</label>
                    <input type="checkbox" id="nav-cred-createOptionBox-exclude" name="nav-cred-createOptions-exclude"
                           class="nav-cred-createOptionBox" checked
                           onchange="ShowSection('nav-cred-createOptions-exclude','nav-cred-createOptionBox', 'nav-cred-createOptions-exclude', 'nav-cred-createOptionBox-exclude', true, 'checkbox', 'table')">
                    <label for="nav-cred-createOptionBox-authSec">Auth. Selector</label>
                    <input type="checkbox" id="nav-cred-createOptionBox-authSec" name="nav-cred-createOptions-authSec"
                           class="nav-cred-createOptionBox" checked
                           onchange="ShowSection('nav-cred-createOptions-authSec','nav-cred-createOptionBox', 'nav-cred-createOptions-authSec', 'nav-cred-createOptionBox-authSec', true, 'checkbox', 'table')">

                    <label for="nav-cred-createOptionBox-attSec">Attestations</label>
                    <input type="checkbox" id="nav-cred-createOptionBox-attSec" name="nav-cred-createOptions-attSec"
                           class="nav-cred-createOptionBox" checked
                           onchange="ShowSection('nav-cred-createOptions-attSec','nav-cred-createOptionBox', 'nav-cred-createOptions-attSec', 'nav-cred-createOptionBox-attSec', true, 'checkbox', 'table')">
                </td>
            </tr>
        </table>
        <table class="simpleTable">
            <thead>
            <tr>
                <th>Attribute</th>
                <th>Value</th>
                <th>Action</th>
                <th>Validations & Guidance</th>
            </tr>
            </thead>
            <tbody>
            <tr class="nav-cred-createOptions-rp">
                <td colspan="2">
                    <a href="https://w3c.github.io/webauthn/#dictdef-publickeycredentialrpentity" target="_blank">
                        Relying party
                    </a></td>
                <td><label for="nav-cred-create-rp-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-rp-set"
                           name="nav-cred-create-rp-set" checked class="nav-cred-create"
                           value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://w3c.github.io/webauthn/#dictdef-publickeycredentialrpentity"
                               target="_blank">
                            PublicKeyCredentialRpEntity</a></li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-rp">
                <td><label for="nav-cred-create-rp.id">
                    <a href="https://w3c.github.io/webauthn/#dom-publickeycredentialrpentity-id"
                       target="_blank">Relying Party ID (domain name e.g. www.acme.org, acme.org)</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-create-rp.id" class="nav-cred-create"></input>
                </td>
                <td>
                    <label for="nav-cred-create-rp.id-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-rp.id-set" name="nav-cred-create-rp.id-set" checked
                           class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#rp-id"
                               target="_blank">Valid Domain string</a><BR>
                            Default: origin's <a
                                    hef="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-effective-domain">effective
                                domain</a><BR>
                            Allowed: Suffix of origin (e.g. origin a1.a2.acme.com, then a2.acme.com & acme.com are
                            allowed)<BR>

                        </li>
                        <li>Does not contain scheme or port. Scheme should be https & port is unrestricted
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-rp">
                <td><label for="nav-cred-create-rp.name">
                    <a href="https://w3c.github.io/webauthn/#dom-publickeycredentialentity-name"
                       target="_blank">Relying Party Name (human palatable name e.g. ACME Corp)</a></label></td>
                <td>
                    <input type="text" id="nav-cred-create-rp.name" class="nav-cred-create"></input>
                </td>
                <td>
                    <label for="nav-cred-create-rp.name-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-rp.name-set" name="nav-cred-create-rp.name-set" checked
                           class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>DOMString</li>
                        <li>Formatting: <a href="https://www.rfc-editor.org/rfc/rfc8266#section-2.3"
                                           target="_blank">RFC8266</a>: trim
                            space, compact multi-space,NFKC Normalize, non-empty
                        </li>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-strings-langdir" target="_blank">Language &
                            directional encoding</a>: Tag Language(U+E0001),
                            direction(L-R:U+200E,R-L:U+200F,Cancel:U+E007F)
                        </li>
                        <li>May be <a href="https://w3c.github.io/webauthn/#sctn-strings-truncation" target="_blank">truncated</a>
                            to 64 bytes by authenticators
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-user">
                <td colspan="2">
                    <a href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-user"
                       target="_blank">User</a>
                </td>
                <td><label for="nav-cred-create-user-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-user-set" name="nav-cred-create-user-set" checked
                           class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://w3c.github.io/webauthn/#dictdef-publickeycredentialuserentity"
                               target="_blank">
                            PublicKeyCredentialUserEntity</a></li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-user">
                <td><label for="nav-cred-create-user.id"><a
                        href="https://w3c.github.io/webauthn/#dictdef-publickeycredentialuserentity" target="_blank">User
                    ID</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-create-user.id" class="nav-cred-create"></input>
                </td>
                <td>
                    <label for="nav-cred-create-user.id-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-user.id-set" name="nav-cred-create-user.id-set" checked
                           class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>BufferSource</li>
                        <li><a href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-user"
                               target="_blank">User.ID + RP.ID combination</a> must be unique in authenticator (or it
                            may
                            override previous
                            discoverable credential)
                        </li>
                        <li>Max size:64</li>
                        <li>No PII data</li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-user">
                <td><label for="nav-cred-create-user.name">
                    <a href="https://w3c.github.io/webauthn/#dom-publickeycredentialentity-name"
                       target="_blank">User Name</a></label>
                    (may be chosen by user to differentiate with similar display name)
                </td>
                <td>
                    <input type="text" id="nav-cred-create-user.name" class="nav-cred-create"></input>
                </td>
                <td>
                    <label for="nav-cred-create-user.name-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-user.name-set" name="nav-cred-create-user.name-set"
                           checked class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>DOMString</li>
                        <li>Formatting: <a href="https://www.rfc-editor.org/rfc/rfc8265#section-3.4.3"
                                           target="_blank">RFC 8265</a> (UsernameCasePreserved): NFC Normalize, Bidi
                            Rule,
                            non-empty
                        </li>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-strings-langdir" target="_blank">Language &
                            directional encoding</a>: Tag Language(U+E0001),
                            direction(L-R:U+200E,R-L:U+200F,Cancel:U+E007F)
                        </li>
                        <li>May be <a href="https://w3c.github.io/webauthn/#sctn-strings-truncation" target="_blank">truncated</a>
                            to 64 bytes by authenticators
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-user">
                <td><label for="nav-cred-create-user.displayName">
                    <a href="https://w3c.github.io/webauthn/#dom-publickeycredentialuserentity-displayname"
                       target="_blank">User Display Name</a></label>
                    (User must choose it)
                </td>
                <td>
                    <input type="text" id="nav-cred-create-user.displayName" class="nav-cred-create"></input>
                </td>
                <td>
                    <label for="nav-cred-create-user.displayName-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-user.displayName-set" class="nav-cred-create"
                           name="nav-cred-create-user.displayName-set" checked value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>DOMString</li>
                        <li>Formatting: <a href="https://www.rfc-editor.org/rfc/rfc8266#section-2.3"
                                           target="_blank">RFC8266</a>: trim
                            space, compact multi-space,NFKC Normalize, non-empty
                        </li>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-strings-langdir" target="_blank">Language &
                            directional encoding</a>: Tag Language(U+E0001),
                            direction(L-R:U+200E,R-L:U+200F,Cancel:U+E007F)
                        </li>
                        <li>May be <a href="https://w3c.github.io/webauthn/#sctn-strings-truncation" target="_blank">truncated</a>
                            to 64 bytes by authenticators
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-others">
                <td colspan="4">Other attributes</td>
            </tr>
            <tr class="nav-cred-createOptions-others">
                <td><label for="nav-cred-create-challenge"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-challenge"
                        target="_blank">Challenge</a></label></td>
                <td>
                    <input type="text" id="nav-cred-create-challenge" class="nav-cred-create"></input>
                </td>
                <td>
                    <label for="nav-cred-create-challenge-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-challenge-set" name="nav-cred-create-challenge-set"
                           checked class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>BufferSource</li>
                        <li>Generated on Server; stored for validation of response</li>
                        <li><a href="https://w3c.github.io/webauthn/#dom-collectedclientdata-challenge" target="_blank">Base64
                            encoded</a></li>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-cryptographic-challenges" target="_blank">Randomized</a>
                            with enough entropy to make guessing infeasible
                        </li>
                        <li>Min size: 16 bytes</li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-others">
                <td><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-pubkeycredparams"
                        target="_blank">Public Key credential parameters</a>
                </td>
                <td>
                    <label for="nav-cred-create-pubKeyCredParams-options-ed25519">Ed25519</label>
                    <input type="checkbox" id="nav-cred-create-pubKeyCredParams-options-ed25519"
                           class="nav-cred-create nav-cred-create-pubKeyCredParams-options"
                           name="nav-cred-create-pubKeyCredParams-options-ed25519"
                           checked value='-8'>
                    <label for="nav-cred-create-pubKeyCredParams-options-es256">ES256</label>
                    <input type="checkbox" id="nav-cred-create-pubKeyCredParams-options-es256"
                           class="nav-cred-create nav-cred-create-pubKeyCredParams-options"
                           name="nav-cred-create-pubKeyCredParams-options-es256"
                           checked value='-7'>
                    <label for="nav-cred-create-pubKeyCredParams-options-rs256">RS256 (?)</label>
                    <input type="checkbox" id="nav-cred-create-pubKeyCredParams-options-rs256"
                           class="nav-cred-create nav-cred-create-pubKeyCredParams-options"
                           name="nav-cred-create-pubKeyCredParams-options-rs256"
                           checked value='-257'>
                    <BR>
                    TODO: Add all the allowed values from the IANA registry
                </td>
                <td><label for="nav-cred-create-pubKeyCredParams-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-pubKeyCredParams-set"
                           name="nav-cred-create-pubKeyCredParams-set" class="nav-cred-create" checked value="Set">
                </td>
                <td>
                    <h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://w3c.github.io/webauthn/#dictdef-publickeycredentialparameters"
                               target="_blank">PublicKeyCredentialParameters</a>
                            {type (DOMString/Required):<a
                                    href="https://w3c.github.io/webauthn/#enumdef-publickeycredentialtype"
                                    target="_blank">'public-key'</a>,
                            alg (long/Required): <a
                                    href="https://w3c.github.io/webauthn/#typedefdef-cosealgorithmidentifier"
                                    target="_blank">COSEAlgorithmIdentifier</a>}
                        </li>
                        <li><a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms" target="_blank">IANA
                            COSE
                            Algorithms Registry</a></li>
                        <li>Additional guarantees for
                            <a href="https://w3c.github.io/webauthn/#typedefdef-cosealgorithmidentifier"
                               target="_blank">credential
                                public key</a>
                            (e.g. not use compressed point form for ES*) in alignment with <a
                                    href="https://www.rfc-editor.org/rfc/rfc9053#section-2.1"
                                    target="_blank">RFC9053</a>
                        </li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li><a href="https://en.wikipedia.org/wiki/WebAuthn#Reception" target="_blank">Support for RSA
                            discouraged</a></li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-others">
                <td><label for="nav-cred-create-timeout"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-timeout"
                        target="_blank">Timeout </a>(millis)</label></td>
                <td>
                    <input type="text" id="nav-cred-create-timeout" class="nav-cred-create"></input>
                </td>
                <td><label for="nav-cred-create-timeout-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-timeout-set" name="nav-cred-create-timeout-set"
                           class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>unsigned long</li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>Treated as <a
                                href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-timeout"
                                target="_blank">hint</a>
                            & MAY be overridden by client (browser)
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-exclude">
                <td><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-excludecredentials"
                        target="_blank">Exclude credentials </a></td>
                <td>
                    <div id="nav-cred-create-excludeCredentials-list">Generate once another sesion with credential has
                        been
                        registered.
                    </div>
                </td>
                <td><label for="nav-cred-create-excludeCredentials-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-excludeCredentials-set"
                           name="nav-cred-create-excludeCredentials-set" class="nav-cred-create" value="Set">
                    <input type="button" id="nav-cred-create-excludeCredentials-generate"
                           name="nav-cred-create-excludeCredentials-generate" class="nav-cred-create" value="Generate"
                           onclick="GenerateExcludedCredential(sessions, 'nav-cred-create-excludeCredentials-list')">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>Array of <a href="https://w3c.github.io/webauthn/#dictdef-publickeycredentialdescriptor"
                                        target="_blank">PublicKeyCredentialDescriptor</a> that are existing credential
                            mapped to user
                            {
                            type (DOMString/Required): <a
                                    href="https://w3c.github.io/webauthn/#enumdef-publickeycredentialtype">'public-key'</a>,
                            id (BufferSource/Required): Credential ID (<a
                                    href="https://w3c.github.io/webauthn/#dom-publickeycredential-rawid"
                                    target="_blank">rawID</a>
                            of PublicKeyCredential),
                            transports ([]DOMString/Optional): Applicable <a
                                    href="https://w3c.github.io/webauthn/#enumdef-authenticatortransport">AuthenticatorTransport</a>
                            (usb/nfc/ble/hybrid/internal)
                            }
                        </li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>New credential not created on authenticator for giver user.id + rp.id if given credential(s)
                            <a
                                    href="https://w3c.github.io/webauthn/#bound-credential" target="_blank">already
                                exists</a>
                            on the authenticator.
                            Guide user to use a diff authenticator or error if that fails.
                        </li>
                        <li>Need to provide credential raw id (is that a security/privacy issue?)TODO: Need analysis
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-authSec">
                <td colspan="2"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-authenticatorselection"
                        target="_blank">Authenticator Selection</a></td>
                <td><label for="nav-cred-create-authenticatorSelection-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-authenticatorSelection-set"
                           name="nav-cred-create-authenticatorSelection-set" class="nav-cred-create" value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li><a href="https://w3c.github.io/webauthn/#dictdef-authenticatorselectioncriteria"
                               target="_blank"> AuthenticatorSelectionCriteria</a></li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-authSec">
                <td><label for="nav-cred-create-authenticatorSelection.authenticatorAttachment"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-authenticatorselection"
                        target="_blank">Authenticator attachment </a></label></td>
                <td>
                    <select name="nav-cred-create-authenticatorSelection.authenticatorAttachment"
                            id="nav-cred-create-authenticatorSelection.authenticatorAttachment" class="nav-cred-create">
                        <option value="platform">Platform</option>
                        <option value="cross-platform">Cross Platform</option>
                        <option value="invalidVal" selected>Not selected</option>
                    </select>
                </td>
                <td><label for="nav-cred-create-authenticatorSelection.authenticatorAttachment-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-authenticatorSelection.authenticatorAttachment-set"
                           name="nav-cred-create-authenticatorSelection.authenticatorAttachment-set"
                           class="nav-cred-create" value="Set"></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#enum-attachment" target="_blank">Allowed values</a>:
                            'platform'/'cross-platform'
                        </li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-authenticator-attachment-modality">'platform'(not
                            removable from device)/'cross-platform' (removable)</a></li>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-authenticator-attachment-modality"
                               target="_blank">Some</a> platform authenticators can be roaming (e.g. TPM on mobile
                            available through bluetooth)
                        </li>
                        <li>TODO: There is no specific guidance on passkeys in this context</li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-authSec">
                <td><label for="nav-cred-create-authenticatorSelection.residentKey"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorselectioncriteria-residentkey"
                        target="_blank">Resident key (Discoverable?) </a></label></td>
                <td>
                    <select name="nav-cred-create-authenticatorSelection.residentKey"
                            id="nav-cred-create-authenticatorSelection.residentKey" class="nav-cred-create">
                        <option value="invalidVal" selected>Not selected</option>
                        <option value="discouraged">Discouraged (Server side)</option>
                        <option value="preferred">Preferred (Discoverable)</option>
                        <option value="required">Required (Discoverable)</option>
                    </select>
                </td>
                <td><label for="nav-cred-create-authenticatorSelection.residentKey-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-authenticatorSelection.residentKey-set"
                           class="nav-cred-create" name="nav-cred-create-authenticatorSelection.residentKey-set"
                           value="Set"></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#enumdef-residentkeyrequirement" target="_blank">Allowed
                            values</a>:
                            'discouraged'/'preferred'/'required'
                        </li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li><a href="https://w3c.github.io/webauthn/#server-side-credential"
                               target="_blank">server side credential</a></li>
                        <li>Preferred supersedes userVerification setting</li>
                        <li><a href="https://w3c.github.io/webauthn/#dom-residentkeyrequirement-discouraged">Server side
                            credential</a>: there is no way for RP to know if credential is server side or not & so does
                            not
                            know if
                            creating a second cred with same handle will evict the first (TODO: does this mean that
                            excluded
                            cred must be provided explicitly)
                        </li>
                        <li>Client side discoverable credential can be validated using <a
                                href="https://w3c.github.io/webauthn/#dom-credentialpropertiesoutput-rk">CredentialPropertiesOutput.rk</a>
                            extension.
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-authSec">
                <td><label for="nav-cred-create-authenticatorSelection.requireResidentKey"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorselectioncriteria-requireresidentkey"
                        target="_blank">Require resident key</a></label></td>
                <td>
                    <label for="nav-cred-create-authenticatorSelection.requireResidentKey">Resident key
                        required?</label>
                    <input type="checkbox" name="nav-cred-create-authenticatorSelection.requireResidentKey"
                           class="nav-cred-create nav-cred-create-authenticatorSelection.requireResidentKey-options"
                           id="nav-cred-create-authenticatorSelection.requireResidentKey" value="true">
                </td>
                <td><label for="nav-cred-create-authenticatorSelection.requireResidentKey-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-authenticatorSelection.requireResidentKey-set"
                           name="nav-cred-create-authenticatorSelection.requireResidentKey-set"
                           class="nav-cred-create"
                           value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>boolean</li>
                        <li>Default value: false</li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>
                            <a href="https://w3c.github.io/webauthn/#dom-authenticatorselectioncriteria-requireresidentkey"
                               target="_blank">requireResidentKey</a> must be set to true if residentKey is set to
                            required
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-authSec">
                <td><label for="nav-cred-create-authenticatorSelection.userVerification"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorselectioncriteria-userverification"
                        target="_blank">User verification</a></label></td>
                <td>
                    <select name="nav-cred-create-authenticatorSelection.userVerification"
                            id="nav-cred-create-authenticatorSelection.userVerification" class="nav-cred-create">
                        <option value="invalidVal">Not selected</option>
                        <option value="discouraged">Discouraged (no user verification)</option>
                        <option value="preferred" selected>Preferred (not fail on missing/error)</option>
                        <option value="required">Required (fail if missing/error)</option>
                    </select>
                </td>
                <td><label for="nav-cred-create-authenticatorSelection.userVerification-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-authenticatorSelection.userVerification-set"
                           name="nav-cred-create-authenticatorSelection.userVerification-set" class="nav-cred-create"
                           value="Set"></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#enumdef-userverificationrequirement"
                               target="_blank">Allowed
                            values</a>: required/"preferred"/"discouraged"
                        </li>
                        <li>Default value: preferred</li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>How to handle error condition for preferred?</li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-attSec">
                <td><label for="nav-cred-create-attestation"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-attestation"
                        target="_blank">Attestation</a></label></td>
                <td>
                    <select name="nav-cred-create-attestation"
                            id="nav-cred-create-attestation" class="nav-cred-create">
                        <option value="invalidVal">Not selected</option>
                        <option value="none" selected>None (no attestation needed)</option>
                        <option value="indirect">Indirect (client/browser may change it)</option>
                        <option value="direct">Direct (as provided by authenticator)</option>
                        <option value="enterprise">Enterprise (may contain unique identifier)</option>
                    </select>
                </td>
                <td><label for="nav-cred-create-attestation-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-attestation-set"
                           name="nav-cred-create-attestation-set" class="nav-cred-create"
                           value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#enumdef-attestationconveyancepreference"
                               target="_blank">Allowed values</a>: "none"/"indirect"/"direct"/"enterprise"
                        </li>
                        <li>Default value: none</li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>Attestation conveyance definition is cyclic in the specification</li>
                        <li>Values
                            <ol>
                                <li><b>none</b>: RP not interested due to
                                    <ol>
                                        <li>avoid user consent</li>
                                        <li>save round trip to attestation CA or Anon CA</li>
                                    </ol>
                                    If authenticator generates self-attestation, it is passed through by
                                    client. All other attestations are <a
                                            href="https://w3c.github.io/webauthn/#dom-attestationconveyancepreference-none"
                                            target="_blank">replaced</a> with none by client.
                                </li>
                                <li><b>indirect</b>: client (e.g. browser) decided which attestation statement is
                                    provided.
                                    Client may replace authenticator attestation with anonymous attestation (for
                                    privacy).
                                    No guarantee of receiving verifiable attestation (may receive self-attestation).
                                </li>
                                <li><b>direct</b>: receive exactly what was generated by authenticator. ??what if there
                                    is
                                    nothing generated??
                                </li>
                                <li><b>enterprise</b>: attestation may include uniquely identifying information.
                                    Typically,
                                    explicitly configured in client/user agent for specific RP (Relying Party) ID
                                    (domain).
                                    Client/user agent should not change the value.
                                </li>
                            </ol>
                        </li>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-attestation-types" target="_blank"> Types of
                            Attestation</a>:
                            <ol>
                                <li><b>Basic/Batch</b> - Authenticator of same model share same attestation key pair
                                </li>
                                <li><b>Self</b> - uses credential private key to create attestation signature</li>
                                <li><b>Attestation CA (AttCA)</b> - Endorsement key stored in TPM used to communicate
                                    with
                                    Attestation/Privacy CA
                                    and get Attestation Identity Key (AIK) Certificate signed. AIK can be generated for
                                    each
                                    credential and shared
                                    as attestation cert with RP. Most recent cert is called "Active"
                                </li>
                                <li><b>Anonymization CA (AnonCA)</b> - dynamically generated per-credential certificate
                                </li>
                            </ol>
                        </li>
                        <li>All attestations are distinguishable only with <a
                                href="https://w3c.github.io/webauthn/#anonymization-ca" target="_blank">externally
                            provided
                            knowledge</a> (???) regarding content of att cert.
                        </li>
                    </ol>
                </td>
            </tr>
            <tr class="nav-cred-createOptions-attSec">
                <td><a href="https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-attestationformats"
                       target="_blank">Preferred Attestation Formats</a></td>
                <td>
                    <label for="nav-cred-create-attestationFormats-options-packed">Packed</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-packed"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-packed"
                           checked value='packed'>
                    <label for="nav-cred-create-attestationFormats-options-tpm">TPM</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-tpm"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-tpm"
                           checked value='tpm'>
                    <label for="nav-cred-create-attestationFormats-options-android_key">Android key</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-android_key"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-android_key"
                           checked value='android-key'>
                    <label for="nav-cred-create-attestationFormats-options-android_safetynet">Android Safetynet
                        API</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-android_safetynet"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-android_safetynet"
                           checked value='android-safetynet'>
                    <label for="nav-cred-create-attestationFormats-options-fido_u2f">FIDO U2F</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-fido_u2f"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-fido_u2f"
                           checked value='fido-u2f'>
                    <label for="nav-cred-create-attestationFormats-options-apple">Apple</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-apple"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-apple"
                           checked value='apple'>
                    <label for="nav-cred-create-attestationFormats-options-none">None</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-options-none"
                           class="nav-cred-create nav-cred-create-attestationFormats-options"
                           name="nav-cred-create-attestationFormats-options-none"
                           value='none'>
                </td>
                <td><label for="nav-cred-create-attestationFormats-set">Set value</label>
                    <input type="checkbox" id="nav-cred-create-attestationFormats-set"
                           name="nav-cred-create-attestationFormats-set" class="nav-cred-create"
                           value="Set">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>[]DOMString</li>
                        <li>Allowed values
                            <a href="https://www.iana.org/assignments/webauthn/webauthn.xhtml" target="_blank">IANA
                                WebAuthn
                                Registry</a></li>
                        <li>Default value: []</li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>Order value from most preferable to least preferable (Not supported)</li>
                        <li>Parameter is advisory and authenticator may use format not specified.</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td>attr</td>
                <td>val</td>
                <td>action</td>
                <td>val&guide</td>
            </tr>
            </tbody>
        </table>
    </div>
    <div id="nav-cred-createSection-genCreds" class="nav-cred-createSections tabcontent" style="display: none">
        <p>
            <input type="button" name="nav-cred-create-createCredential" value="Create Credential"
                   onclick="CredentialCreate(currentSession);"/>
            <input type="button" name="nav-cred-create-setCredential" value="Set Credential"
                   onclick="SetObject(currentSession['nav-cred-create-credential'], 'nav-cred-obj','nav-cred-obj')"/>
            <input type="button" name="nav-cred-create-ParseCredential" value="Parse Credential"
                   onclick="GetURL(API_ENDPOINTS.parseCredential, currentSession,'nav-cred-create-logging');SetObject(currentSession['nav-cred-create-credential-parsed'], 'nav-cred-obj-parse','nav-cred-obj-parse')">
        </p>
        <table class="simpleTable">
            <thead>
            <tr>
                <th colspan="2">Attribute</th>
                <th>Value</th>
                <th>Action</th>
                <th>Validations & Guidance</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-authenticatorAttachment"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredential-authenticatorattachment"
                        target="_blank">Authenticator attachment type</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-authenticatorAttachment" class="nav-cred-obj"></input>
                </td>
                <td></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#enumdef-authenticatorattachment" target="_blank">Valid
                            values</a>: platform/cross-platform
                        </li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-rawId"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredential-rawid"
                        target="_blank">Raw ID</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-rawId" class="nav-cred-obj"></input>
                </td>
                <td><label for="nav-cred-obj-rawId-B64Encoded">
                    <input type="button" id="nav-cred-obj-rawId-Base64" name="nav-cred-obj-rawId-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-rawId');"></label>
                    <input type="checkbox" id="nav-cred-obj-rawId-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-rawId');"></input>

                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li>ArrayBuffer</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-toJSON"><a
                        href="https://w3c.github.io/webauthn/#dom-publickeycredential-tojson"
                        target="_blank">JSON Representation</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-toJSON" class="nav-cred-obj"></input>
                </td>
                <td></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Generated</li>
                        <li><a href="https://w3c.github.io/webauthn/#dictdef-registrationresponsejson" target="_blank">RegistrationResponseJSON</a>
                        </li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-id"><a
                        href="https://w3c.github.io/webappsec-credential-management/#dom-credential-id"
                        target="_blank">ID</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-id" class="nav-cred-obj"></input>
                </td>
                <td></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://webidl.spec.whatwg.org/#idl-USVString" target="_blank">USVString</a>
                        </li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="4"><a href="https://w3c.github.io/webauthn/#dom-publickeycredential-response"
                                   target="_blank">Response</a></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://w3c.github.io/webauthn/#authenticatorresponse" target="_blank">AuthenticatorResponse</a>
                        </li>
                        <li><a href="https://w3c.github.io/webauthn/#authenticatorattestationresponse" target="_blank">AuthenticatorAttestationResponse</a>
                        </li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-response.clientDataJSON"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorresponse-clientdatajson"
                        target="_blank">clientDataJSON</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-response.clientDataJSON" class="nav-cred-obj"></input>
                </td>
                <td></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li>ArrayBuffer</li>
                        <li><a href="https://w3c.github.io/webauthn/#dictdef-collectedclientdata" target="_blank">Collected
                            Client Data format</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td rowspan="5"></td>
                <td><label for="nav-cred-obj-parse-Response.CollectedClientData.type"><a
                        href="https://w3c.github.io/webauthn/#dom-collectedclientdata-type" target="_blank">
                    Type</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.CollectedClientData.type"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td></td>
                <td><h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>DOMString</li>
                        <li>Values: 'webauthn.create'/'webauthn.get'</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td><label for="nav-cred-obj-parse-Response.CollectedClientData.challenge"><a
                        href="https://w3c.github.io/webauthn/#dom-collectedclientdata-challenge" target="_blank">
                    Challenge</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.CollectedClientData.challenge"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td><label for="nav-cred-obj-parse-Response.CollectedClientData.challenge">
                    <input type="button" id="nav-cred-obj-parse-Response.CollectedClientData.challenge-Base64"
                           name="nav-cred-obj-parse-Response.CollectedClientData.challenge-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-parse-Response.CollectedClientData.challenge');"></label>
                    <input type="checkbox" id="nav-cred-obj-parse-Response.CollectedClientData.challenge-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-parse-Response.CollectedClientData.challenge');">
                </td>
                <td><h4>Validations</h4>
                    <ol>
                        <li>Required</li>
                        <li>DOMString</li>
                        <li>Values: 'webauthn.create'/'webauthn.get'</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td><label for="nav-cred-obj-parse-Response.CollectedClientData.origin"><a
                        href="https://w3c.github.io/webauthn/#dom-collectedclientdata-origin" target="_blank">Origin</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.CollectedClientData.origin"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td></td>
                <td><h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li>DOMString</li>
                        <li><a href="https://www.rfc-editor.org/rfc/rfc6454" target="_blank">RFC6454</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td><label for="nav-cred-obj-parse-Response.CollectedClientData.topOrigin"><a
                        href="https://w3c.github.io/webauthn/#dom-collectedclientdata-toporigin" target="_blank">Top
                    level Origin</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.CollectedClientData.topOrigin"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td></td>
                <td><h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>DOMString</li>
                        <li><a href="https://www.rfc-editor.org/rfc/rfc6454" target="_blank">RFC6454</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td><label for="nav-cred-obj-parse-Response.CollectedClientData.crossOrigin"><a
                        href="https://w3c.github.io/webauthn/#dom-collectedclientdata-crossorigin" target="_blank">Cross
                    Origin?</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.CollectedClientData.crossOrigin"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td></td>
                <td><h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>Boolean</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-response.getTransports"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorattestationresponse-gettransports"
                        target="_blank">Transports</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-response.getTransports" class="nav-cred-obj"></input>
                </td>
                <td>
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li>Array of DOMString</li>
                        <li><a href="https://w3c.github.io/webauthn/#enumdef-authenticatortransport" target="_blank">Authenticator
                            transport</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-response.getAuthenticatorData"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorattestationresponse-getauthenticatordata"
                        target="_blank">Authenticator Data</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-response.getAuthenticatorData" class="nav-cred-obj"></input>
                </td>
                <td><label for="nav-cred-obj-response.getAuthenticatorData-B64Encoded">
                    <input type="button" id="nav-cred-obj-response.getAuthenticatorData-Base64"
                           name="nav-cred-obj-response.getAuthenticatorData-Base64"
                           value="Base64 Encode" onclick="Base64Encoder('nav-cred-obj-response.getAuthenticatorData');"></label>
                    <input type="checkbox" id="nav-cred-obj-response.getAuthenticatorData-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-response.getAuthenticatorData');">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li>ArrayBuffer</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-response.getPublicKey"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorattestationresponse-getpublickey"
                        target="_blank">Public Key</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-response.getPublicKey" class="nav-cred-obj"></input>
                </td>
                <td><label for="nav-cred-obj-response.getPublicKey-B64Encoded">
                    <input type="button" id="nav-cred-obj-response.getPublicKey-Base64"
                           name="nav-cred-obj-response.getPublicKey-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-response.getPublicKey');"></label>
                    <input type="checkbox" id="nav-cred-obj-response.getPublicKey-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-response.getPublicKey');"></input>
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Optional</li>
                        <li>ArrayBuffer</li>
                        <li><a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.7" target="_blank">DER
                            Subject Public Key Info</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-response.getPublicKeyAlgorithm"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorattestationresponse-getpublickeyalgorithm"
                        target="_blank">Public Key algorithm</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-response.getPublicKeyAlgorithm" class="nav-cred-obj"></input>
                </td>
                <td>
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://w3c.github.io/webauthn/#typedefdef-cosealgorithmidentifier"
                               target="_blank">COSEAlgorithmIdentifier</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="2"><label for="nav-cred-obj-response.attestationObject"><a
                        href="https://w3c.github.io/webauthn/#dom-authenticatorattestationresponse-attestationobject"
                        target="_blank">Attestation Object</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-response.attestationObject" class="nav-cred-obj"></input>
                </td>
                <td><label for="nav-cred-obj-response.attestationObject-B64Encoded">
                    <input type="button" id="nav-cred-obj-response.attestationObject-Base64"
                           name="nav-cred-obj-response.attestationObject-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-response.attestationObject');"></label>
                    <input type="checkbox" id="nav-cred-obj-response.attestationObject-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-response.attestationObject');">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li>ArrayBuffer</li>
                        <li><a href="https://w3c.github.io/webauthn/#attestation-object">CBOR Format</a></li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li><a href="https://w3c.github.io/webauthn/#sctn-attestation" target="_blank">Contains</a>
                            format, attestation statement (based on format) & Authenticator data
                        </li>
                        <li>Signed by <a href="https://w3c.github.io/webauthn/#attestation-key-pair" target="_blank">
                            Attestation</a>key pair
                        </li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td></td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.fmt"><a
                        href="https://w3c.github.io/webauthn/#sctn-attstn-fmt-ids"
                        target="_blank">Format</a></label></td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.AttestationObject.fmt"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td></td>
                <td><h4>Validation</h4>
                    <ol>
                        <li>String</li>
                        <li>Required</li>
                        <li><a href="https://www.iana.org/assignments/webauthn/webauthn.xhtml" target="_blank">Allowed
                            values</a> (Defined by <a href="https://www.rfc-editor.org/rfc/rfc8809.html"
                                                      target="_blank">RFC8809</a>): 'packed'/'tpm'/'android-key'/...
                        </li>
                    </ol>
                    <h4>Guidance</h4>
                    <ol>
                        <li>Specifies the format of attestation statement</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td colspan="5"><a
                        href="https://w3c.github.io/webauthn/#authenticator-data"
                        target="_blank">Authenticator Data</a> TODO: figure out att stmt and add
                </td>
            </tr>
            <tr>
                <td rowspan="4"></td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid"><a
                        href="https://w3c.github.io/webauthn/#authdata-rpidhash"
                        target="_blank">RP ID Hash</a></label></td>
                <td><input type="text" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid-B64Encoded">
                    <input type="button" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid-Base64"
                           name="nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid');"></label>
                    <input type="checkbox" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-parse-Response.AttestationObject.AuthData.rpid');">
                </td>
                <td><h4>Validation</h4>
                    <ol>
                        <li>length 32 bytes</li>
                        <li>SHA256 hash of RP ID</li>
                        <li>TODO: Add validation against given value in option & client JSON</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags"><a
                        href="https://w3c.github.io/webauthn/#authdata-flags" target="_blank">Flags</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags"
                           class="nav-cred-obj-parse"></input>
                    <table class="emptyTable">
                        <thead>
                        <tr>
                            <th>Bit</th>
                            <th>Name</th>
                            <th>Value</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>0</td>
                            <td><a href="https://w3c.github.io/webauthn/#concept-user-present" target="_blank">User
                                Present[0-absent]</a></td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-0"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Reserved for future use</td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-1"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><a href="https://w3c.github.io/webauthn/#concept-user-verified" target="_blank">User
                                Verified</a> (1-verified)
                            </td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-2"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><a href="https://w3c.github.io/webauthn/#backup-eligibility" target="_blank">Backup
                                Eligible</a> (0-single/1-multi-device)
                            </td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-3"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><a href="https://w3c.github.io/webauthn/#backup-state" target="_blank">Backup state</a>
                                (1-backed up/0-not backed up)
                            </td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-4"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Reserved for future use</a></td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-5"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td><a href="https://w3c.github.io/webauthn/#attested-credential-data" target="_blank">Attested
                                credential data included?</a></td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-6"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td><a href="https://w3c.github.io/webauthn/#authdata-extensions" target="_blank">Extension
                                included?</a></td>
                            <td>
                                <div id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-7"></div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </td>
                <td><input type="button" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-Parse"
                           name="nav-cred-obj-parse-Response.AttestationObject.AuthData.flags-Parse"
                           value="Parse flag"
                           onclick="ParseAttObjectAuthDataFlag('nav-cred-obj-parse-Response.AttestationObject.AuthData.flags');">
                </td>
                <td><h4>Validation</h4>
                    <ol>
                        <li>Length: 1 byte</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.sign_count"><a
                        href="https://w3c.github.io/webauthn/#signature-counter" target="_blank">Sign count</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.sign_count"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td></td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>32-bit unsigned big-endian integer</li>
                        <li>Length: 4 bytes</li>
                    </ol>
                    <h4><a href="https://w3c.github.io/webauthn/#signature-counter" target="_blank">Guidance</a></h4>
                    <ol>
                        <li>Incremented for each successful authentication</li>
                        <li>Authenticator should implement for each credential (SHOULD) or globally for
                            authenticator(MAY)
                        </li>
                        <li>For each credential (SHOULD) or globally for authenticator(MAY)</li>
                        <li>Help RP detect cloned authenticators by storing it</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td></td>
                <td colspan="4"><a href="https://w3c.github.io/webauthn/#sctn-attested-credential-data">Attested
                    Credential Data</a></td>
            </tr>
            <tr>
                <td></td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid"><a
                        href="https://w3c.github.io/webauthn/#authdata-attestedcredentialdata-aaguid" target="_blank">AAGUID
                    of authenticator</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid-B64Encoded">
                    <input type="button"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid-Base64"
                           name="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid');"></label>
                    <input type="checkbox"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.aaguid');">

                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Length: 16 bytes</li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td></td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id"><a
                        href="https://w3c.github.io/webauthn/#authdata-attestedcredentialdata-credentialid"
                        target="_blank">Credential ID</a></label>
                </td>
                <td>
                    <input type="text"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id"
                           class="nav-cred-obj-parse">
                </td>
                <td><label
                        for="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id-B64Encoded">
                    <input type="button"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id-Base64"
                           name="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id');"></label>
                    <input type="checkbox"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.credential_id');">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://w3c.github.io/webauthn/#credential-id">Credential ID format</a></li>
                    </ol>
                </td>
            </tr>
            <tr>
                <td></td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key"><a
                        href="https://w3c.github.io/webauthn/#authdata-attestedcredentialdata-credentialpublickey"
                        target="_blank">Credential Public key</a></label>
                </td>
                <td>
                    <input type="text" id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key"
                           class="nav-cred-obj-parse"></input>
                </td>
                <td><label for="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key-B64Encoded">
                    <input type="button"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key-Base64"
                           name="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key-Base64"
                           value="Base64 Encode"
                           onclick="Base64Encoder('nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key');"></label>
                    <input type="checkbox"
                           id="nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key-B64Encoded"
                           onclick="Base64EncoderFlip('nav-cred-obj-parse-Response.AttestationObject.AuthData.att_data.public_key');">
                </td>
                <td>
                    <h4>Validation</h4>
                    <ol>
                        <li>Required</li>
                        <li><a href="https://datatracker.ietf.org/doc/html/rfc9052#section-7">RFC9052</a> COSE Key
                            format
                        </li>
                    </ol>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div id="nav-cred-get" class="nav-creds">
    Get
</div>
<div id="nav-cred-store" class="nav-creds">
    Store
</div>
<div id="nav-cred-prevent" class="nav-creds">
    Prevent
</div>
<H1>Log & Debug</H1>

<h3>Debug</h3>
<input type="button" value="Clear" onclick="clearLog('common-debug')">
<label for="log-debug-set">Debug</label>
<input type="checkbox" id="log-debug-set" name="log-debug-set" checked value="Set" onchange="ShowHideLog('debug')">
<label for="log-info-set">Info</label>
<input type="checkbox" id="log-info-set" name="log-info-set" checked value="Set" onchange="ShowHideLog('info')">
<label for="log-warn-set">Warn</label>
<input type="checkbox" id="log-warn-set" name="log-warn-set" checked value="Set" onchange="ShowHideLog('warn')">
<label for="log-error-set">Error</label>
<input type="checkbox" id="log-error-set" name="log-error-set" checked value="Set" onchange="ShowHideLog('error')">

<div id="common-debug"></div>

<script>
    SetupDefaultConfiguration()
    ShowCapabilities()
    ShowTab('operationName', 'credential-', 'nav-cred-')
</script>

</body>

</html>